curl -LO "https://dl.k8s.io/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"

sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl

usermod -s /bin/bash jenkins

sudo passwd jenkins

sudo su - jenkins

criar pasta ~/.kube/config e dentro dela colar o cat /etc/rancher/k3s/k3s.yaml do cluster k8s, alterando o server, como abaixo:


apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlRENDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUzTXpRME9ETTBPREV3SGhjTk1qUXhNakU0TURBMU9EQXhXaGNOTXpReE1qRTJNREExT0RBeApXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUzTXpRME9ETTBPREV3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFReDZrcWU0MlBIVmJxVkFVeS9aejlSZ0dTUlBqbVV1S0xpNUNPWWFGMnMKUlBUb1RHL2dMd3R5OFJFVlI2OUJJRTAycFkxRzRPRGs1ZnlJQ1ZHU1FoZU1vMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVBzVjg3UmhTSkJaRmpKSUFUOU5aCklKeW94THd3Q2dZSUtvWkl6ajBFQXdJRFNRQXdSZ0loQUlHUmpab0FzdzRjbUNSa3FqTVg1MGE5SHNPSHdnaloKOEZTcUFvM3ZhbVhZQWlFQXNRTU9DZDZGaVNweWdLWmt4NW1tOFJjV2gvRWp4MXJQcHZSaGxjNCt2OFk9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    server: https://127.0.0.1:6443
  name: default
contexts:
- context:
    cluster: default
    user: default
  name: default
current-context: default
kind: Config
preferences: {}
users:
- name: default
  user:
    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrakNDQVRlZ0F3SUJBZ0lJWURNdVNabFRRSjB3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOek0wTkRnek5EZ3hNQjRYRFRJME1USXhPREF3TlRnd01Wb1hEVEkxTVRJeApPREF3TlRnd01Wb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJDOFFzOFA4RzFKdUlBWGUKUzVneFN4SjUvd0FqWU9Hd3JWVHNnRjlpNWllRXNBVEF3UEJvdWN0eEJoM1JLZGR3RlYwb25BYVBHaFlIU2ZlaApSS3pQTWt1alNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCUnZscjhvMjJzZzdyaTFTWi81WlNXd2NSVWNqakFLQmdncWhrak9QUVFEQWdOSkFEQkcKQWlFQXhNMklCMDRYdUExVHlQME9IOUxNYlM0dkRvZEFscXNodnRkNDE0RmNTV2NDSVFER1p5MS9PWlJUbGpSeQpVTmpwN0I2ZE1ibTMzUytxU1RGTVU2amtwRnBydmc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlCZURDQ0FSMmdBd0lCQWdJQkFEQUtCZ2dxaGtqT1BRUURBakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwClpXNTBMV05oUURFM016UTBPRE0wT0RFd0hoY05NalF4TWpFNE1EQTFPREF4V2hjTk16UXhNakUyTURBMU9EQXgKV2pBak1TRXdId1lEVlFRRERCaHJNM010WTJ4cFpXNTBMV05oUURFM016UTBPRE0wT0RFd1dUQVRCZ2NxaGtqTwpQUUlCQmdncWhrak9QUU1CQndOQ0FBUWpOQjNvSmo1eUllZUlwb2piUmh2UDV5YkVIelB0SDRkQ0JRMzROY2JUCmY2UGFTV0FXTEU3U0o2ZkhUMDFoVGxEUVFFemV0SmdRT2VTM3l3ZXpWcUdvbzBJd1FEQU9CZ05WSFE4QkFmOEUKQkFNQ0FxUXdEd1lEVlIwVEFRSC9CQVV3QXdFQi96QWRCZ05WSFE0RUZnUVViNWEvS050cklPNjR0VW1mK1dVbApzSEVWSEk0d0NnWUlLb1pJemowRUF3SURTUUF3UmdJaEFKRGtieWVBdzV5bVRsL1p5UzViVDRMWjBwVFpmTXdwClA1NW0wZWtzYVMvOEFpRUEva1JOTGc0MHB1bkpqd2pwK05oSzlHRnFhd1l2THptSkNPcHZELytRNkNvPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    client-key-data: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUFoeEwzc1JBWGloTmFnUndpZndqYVlHT2hFeFZnT1JwVi93WFAzZHM2OHpvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFTHhDencvd2JVbTRnQmQ1TG1ERkxFbm4vQUNOZzRiQ3RWT3lBWDJMbUo0U3dCTURBOEdpNQp5M0VHSGRFcDEzQVZYU2ljQm84YUZnZEo5NkZFck04eVN3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=